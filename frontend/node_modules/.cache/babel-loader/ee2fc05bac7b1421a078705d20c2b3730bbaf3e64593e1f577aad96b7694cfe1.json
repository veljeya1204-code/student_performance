{"ast":null,"code":"// import React, { useState, useEffect, useMemo } from 'react';\n// import { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';\n// import Login from './components/Login';\n// import AdminDashboard from './dashboards/AdminDashboard';\n// import TeacherDashboard from './dashboards/TeacherDashboard';\n// import StudentDashboard from './dashboards/StudentDashboard';\n// import ParentDashboard from './dashboards/ParentDashboard';\n// import './App.css';\n\n// function App() {\n//   const [user, setUser] = useState(null);\n//   const [loading, setLoading] = useState(true);\n\n//   // Load user from storage on initial boot\n//   useEffect(() => {\n//     const hydrateAuth = () => {\n//       try {\n//         const storedUser = localStorage.getItem('user');\n//         if (storedUser) {\n//           setUser(JSON.parse(storedUser));\n//         }\n//       } catch (error) {\n//         console.error(\"Failed to parse stored user:\", error);\n//         localStorage.clear();\n//       } finally {\n//         setLoading(false);\n//       }\n//     };\n\n//     hydrateAuth();\n//   }, []);\n\n//   const handleLogin = (userData) => {\n//     // 1. Sync state\n//     setUser(userData);\n//     // 2. Persist to storage\n//     localStorage.setItem('user', JSON.stringify(userData));\n//     if (userData.token) {\n//       localStorage.setItem('token', userData.token);\n//     }\n//   };\n\n//   const handleLogout = () => {\n//     setUser(null);\n//     localStorage.clear();\n//   };\n\n//   // Helper function to decide which dashboard to show\n//   const getDashboardByRole = (userRole) => {\n//     const role = userRole?.toLowerCase();\n//     switch (role) {\n//       case 'admin': return <AdminDashboard user={user} onLogout={handleLogout} />;\n//       case 'teacher': return <TeacherDashboard user={user} onLogout={handleLogout} />;\n//       case 'student': return <StudentDashboard user={user} onLogout={handleLogout} />;\n//       case 'parent': return <ParentDashboard user={user} onLogout={handleLogout} />;\n//       default: return (\n//         <div className=\"error-container\">\n//           <h2>Unauthorized Role</h2>\n//           <p>Your account is not assigned a valid role ({userRole}).</p>\n//           <button onClick={handleLogout}>Return to Login</button>\n//         </div>\n//       );\n//     }\n//   };\n\n//   if (loading) {\n//     return <div className=\"app-loader\">Initializing System...</div>;\n//   }\n\n//   return (\n//     <Router>\n//       <Routes>\n//         {/* If logged in, don't show login page, go straight to dashboard */}\n//         <Route\n//           path=\"/login\"\n//           element={!user ? <Login onLogin={handleLogin} /> : <Navigate to=\"/dashboard\" replace />}\n//         />\n\n//         {/* Unified Dashboard Route with Guard */}\n//         <Route\n//           path=\"/dashboard/*\"\n//           element={\n//             user ? (\n//               getDashboardByRole(user.role)\n//             ) : (\n//               <Navigate to=\"/login\" replace />\n//             )\n//           }\n//         />\n\n//         {/* Redirect root based on auth status */}\n//         <Route \n//           path=\"/\" \n//           element={<Navigate to={user ? \"/dashboard\" : \"/login\"} replace />} \n//         />\n\n//         {/* Catch-all: Redirect unknown routes to home */}\n//         <Route path=\"*\" element={<Navigate to=\"/\" replace />} />\n//       </Routes>\n//     </Router>\n//   );\n// }\n\n// export default App;","map":{"version":3,"names":[],"sources":["/Users/jeyamurugan/Downloads/student/frontend/src/App.js"],"sourcesContent":["// import React, { useState, useEffect, useMemo } from 'react';\n// import { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';\n// import Login from './components/Login';\n// import AdminDashboard from './dashboards/AdminDashboard';\n// import TeacherDashboard from './dashboards/TeacherDashboard';\n// import StudentDashboard from './dashboards/StudentDashboard';\n// import ParentDashboard from './dashboards/ParentDashboard';\n// import './App.css';\n\n// function App() {\n//   const [user, setUser] = useState(null);\n//   const [loading, setLoading] = useState(true);\n\n//   // Load user from storage on initial boot\n//   useEffect(() => {\n//     const hydrateAuth = () => {\n//       try {\n//         const storedUser = localStorage.getItem('user');\n//         if (storedUser) {\n//           setUser(JSON.parse(storedUser));\n//         }\n//       } catch (error) {\n//         console.error(\"Failed to parse stored user:\", error);\n//         localStorage.clear();\n//       } finally {\n//         setLoading(false);\n//       }\n//     };\n\n//     hydrateAuth();\n//   }, []);\n\n//   const handleLogin = (userData) => {\n//     // 1. Sync state\n//     setUser(userData);\n//     // 2. Persist to storage\n//     localStorage.setItem('user', JSON.stringify(userData));\n//     if (userData.token) {\n//       localStorage.setItem('token', userData.token);\n//     }\n//   };\n\n//   const handleLogout = () => {\n//     setUser(null);\n//     localStorage.clear();\n//   };\n\n//   // Helper function to decide which dashboard to show\n//   const getDashboardByRole = (userRole) => {\n//     const role = userRole?.toLowerCase();\n//     switch (role) {\n//       case 'admin': return <AdminDashboard user={user} onLogout={handleLogout} />;\n//       case 'teacher': return <TeacherDashboard user={user} onLogout={handleLogout} />;\n//       case 'student': return <StudentDashboard user={user} onLogout={handleLogout} />;\n//       case 'parent': return <ParentDashboard user={user} onLogout={handleLogout} />;\n//       default: return (\n//         <div className=\"error-container\">\n//           <h2>Unauthorized Role</h2>\n//           <p>Your account is not assigned a valid role ({userRole}).</p>\n//           <button onClick={handleLogout}>Return to Login</button>\n//         </div>\n//       );\n//     }\n//   };\n\n//   if (loading) {\n//     return <div className=\"app-loader\">Initializing System...</div>;\n//   }\n\n//   return (\n//     <Router>\n//       <Routes>\n//         {/* If logged in, don't show login page, go straight to dashboard */}\n//         <Route\n//           path=\"/login\"\n//           element={!user ? <Login onLogin={handleLogin} /> : <Navigate to=\"/dashboard\" replace />}\n//         />\n\n//         {/* Unified Dashboard Route with Guard */}\n//         <Route\n//           path=\"/dashboard/*\"\n//           element={\n//             user ? (\n//               getDashboardByRole(user.role)\n//             ) : (\n//               <Navigate to=\"/login\" replace />\n//             )\n//           }\n//         />\n\n//         {/* Redirect root based on auth status */}\n//         <Route \n//           path=\"/\" \n//           element={<Navigate to={user ? \"/dashboard\" : \"/login\"} replace />} \n//         />\n\n//         {/* Catch-all: Redirect unknown routes to home */}\n//         <Route path=\"*\" element={<Navigate to=\"/\" replace />} />\n//       </Routes>\n//     </Router>\n//   );\n// }\n\n// export default App;"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}